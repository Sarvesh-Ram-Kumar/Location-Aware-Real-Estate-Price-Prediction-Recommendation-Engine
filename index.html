<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üè† House Price Predictor</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <style>
    body {
      background: #f8f9fa;
    }
    .form-card {
      border-radius: 15px;
      padding: 2rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      background: #ffffff;
    }
    .section-title {
      border-left: 4px solid #0d6efd;
      padding-left: 10px;
      margin-bottom: 1rem;
      font-weight: 600;
    }
    .result-card {
      border-radius: 15px;
      padding: 1.5rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      background: #ffffff;
      margin-bottom: 1.5rem;
    }
    .table thead th {
      background: #0d6efd;
      color: white;
    }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#">House Price Predictor</a>
  </div>
</nav>

<div class="container py-5">

  <!-- Form -->
  <div class="form-card mx-auto">
    <h2 class="text-center mb-4">üè† Real Estate Price Prediction and Recommendation System</h2>
    <form method="post">
      {% csrf_token %}

      <!-- General Info -->
      <div class="mb-4">
        <h5 class="section-title">Property Info</h5>
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Property Type</label>
            <select name="PROPERTY_TYPE" class="form-select" required>
              {% for option in property_type_categories %}
                <option value="{{ option }}">{{ option }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Locality</label>
            <select name="LOCALITY" class="form-select" required>
              {% for option in locality_categories %}
                <option value="{{ option }}">{{ option }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Transaction Type</label>
            <input type="number" name="TRANSACT_TYPE" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label class="form-label">Ownership Type</label>
            <input type="number" name="OWNTYPE" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label class="form-label">Age (Years)</label>
            <input type="number" name="AGE" class="form-control" required>
          </div>
        </div>
      </div>

      <!-- Details -->
      <div class="mb-4">
        <h5 class="section-title">House Details</h5>
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Bedrooms</label>
            <input type="number" name="BEDROOM_NUM" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label class="form-label">Bathrooms</label>
            <input type="number" name="BATHROOM_NUM" class="form-control" required>
          </div>
          <div class="col-md-4">
            <label class="form-label">Balconies</label>
            <input type="number" name="BALCONY_NUM" class="form-control" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">Area (sq.ft.)</label>
            <input type="text" name="AREA" class="form-control" required>
          </div>
          <div class="col-md-6">
            <label class="form-label">Furnish</label>
            <select name="FURNISH" class="form-select" required>
              <option value="furnished">Furnished</option>
              <option value="unfurnished">Unfurnished</option>
              <option value="semi-furnished">Semi-Furnished</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Facing</label>
            <select name="FACING" class="form-select" required>
              <option value="north">North</option>
              <option value="south">South</option>
              <option value="east">East</option>
              <option value="west">West</option>
              <option value="north-east">North-East</option>
              <option value="north-west">North-West</option>
              <option value="south-east">South-East</option>
              <option value="south-west">South-West</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">Floor Number</label>
            <input type="number" name="FLOOR_NUM" class="form-control">
          </div>
          <div class="col-md-6">
            <label class="form-label">Total Floors</label>
            <input type="number" name="TOTAL_FLOOR" class="form-control">
          </div>
          <div class="col-md-6">
            <label class="form-label">Total Landmark Count</label>
            <input type="number" name="TOTAL_LANDMARK_COUNT" class="form-control">
          </div>
        </div>
      </div>

      <!-- Scores & Extras -->
      <div class="mb-4">
        <h5 class="section-title">Additional Info</h5>
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Quality Score (0-1)</label>
            <input type="number" step="0.1" name="QUALITY_SCORE" class="form-control">
          </div>
          <div class="col-md-4">
            <label class="form-label">City ID</label>
            <input type="number" name="CITY_ID" class="form-control">
          </div>
          <!-- Features -->
          <div class="col-md-6">
            <label class="form-label">Features</label>
            <div class="border rounded p-2" style="max-height: 200px; overflow-y: auto;">
              {% for name, id in FEATURE_ID_MAP.items %}
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" name="FEATURES" value="{{ name }}" id="feature{{ id }}">
                  <label class="form-check-label" for="feature{{ id }}">
                    {{ name }}-({{ id }})
                  </label>
                </div>
              {% endfor %}
            </div>
          </div>

          <!-- Amenities -->
          <div class="col-md-6">
            <label class="form-label">Amenities</label>
            <div class="border rounded p-2" style="max-height: 200px; overflow-y: auto;">
              {% for name, id in AMENITY_ID_MAP.items %}
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" name="AMENITIES" value="{{ name }}" id="amenity{{ id }}">
                  <label class="form-check-label" for="amenity{{ id }}">
                    {{ name }}-({{ id }})
                  </label>
                </div>
              {% endfor %}
            </div>
          </div>

        </div>
      </div>

      <button type="submit" class="btn btn-primary w-100 btn-lg">Predict Price</button>
    </form>
  </div>

  <!-- Predicted Price -->
  {% if predicted_price %}
  <div class="result-card text-center mx-auto mt-4">
    <h4>üí∞ Predicted Price: ‚Çπ{{ predicted_price|floatformat:2 }}</h4>
  </div>
  {% endif %}

  <!-- Recommendations -->
  {% if recommendations %}
  <div class="result-card mx-auto mt-4">
    <h4 class="mb-3">üè† Recommended Properties</h4>
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>Target Price (‚Çπ)</th>
            <th>Bedrooms</th>
            <th>Area (sq.ft.)</th>
            <th>Furnish</th>
            <th>Match Score (%)</th>
          </tr>
        </thead>
        <tbody>
          {% for rec in recommendations %}
          <tr>
            <td>‚Çπ{{ rec.TARGET_PRICE|floatformat:0 }}</td>
            <td>{{ rec.BEDROOM_NUM }}</td>
            <td>{{ rec.AREA }}</td>
            <td>{{ rec.FURNISH }}</td>
            <td>{{ rec.MATCH_SCORE|floatformat:2 }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

</div>
</body>
</html>
